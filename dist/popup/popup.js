function c(e){const t=document.getElementById(e);if(!t)throw new Error(`Element with id '${e}' not found`);return t}document.addEventListener("DOMContentLoaded",()=>{c("save-to-workspace-form").addEventListener("submit",f),m()});function m(){w().then(e=>{const t=c("workspace-bookmark-title"),r=c("workspace-bookmark-url");t.value=e.title,r.value=e.url,d()})}function w(){return new Promise(e=>{typeof chrome<"u"&&chrome.tabs?chrome.tabs.query({active:!0,currentWindow:!0},t=>{t[0]?e({title:t[0].title||"",url:t[0].url||""}):e({title:"",url:""})}):e({title:"测试页面",url:"https://example.com"})})}function d(){chrome.storage.sync.get(["workspaces"],e=>{const t=e.workspaces||{},r=c("workspace-select");r.innerHTML="";const s=document.createElement("option");s.value="",s.textContent="选择工作区",r.appendChild(s),Object.keys(t).forEach(a=>{const o=t[a];if(o){const n=document.createElement("option");n.value=a,n.textContent=o.name,r.appendChild(n)}})})}function f(e){e.preventDefault();const t=c("workspace-bookmark-title"),r=c("workspace-bookmark-url"),s=c("workspace-select"),a=t.value.trim(),o=r.value.trim(),n=s.value;if(!a||!o||!n){alert("请填写完整信息并选择工作区");return}chrome.storage.sync.get(["workspaces"],k=>{const i=k.workspaces||{};if(!i[n]){alert("工作区不存在");return}if(i[n].bookmarks.find(l=>l.url===o)){alert("该页面已存在于此工作区中");return}let u=`https://www.google.com/s2/favicons?domain=${o}`;try{u=`https://www.google.com/s2/favicons?domain=${new URL(o).hostname}`}catch{u=`https://www.google.com/s2/favicons?domain=${o}`}const p={title:a,url:o,icon:u};i[n].bookmarks.push(p),chrome.storage.sync.set({workspaces:i},()=>{const l=i[n]?.name||"未知工作区";alert(`已保存到工作区: ${l}`),m()})})}
//# sourceMappingURL=popup.js.map
